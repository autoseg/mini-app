<!-- Tab Menu -->
<div class='row justify-content-md-center mb-4'>
  <ul class="nav nav-tabs">
    <% ['all', 'completed', 'incomplete'].each do |task_by_status| %>
      <li class="nav-item">
        <%= link_to task_by_status.capitalize, report_path(filter: task_by_status),
            class: ((params[:filter] ? params[:filter] == task_by_status : task_by_status == 'all') ? "nav-link active" : "nav-link") %>
      </li>
    <% end %>
  </ul>
</div>


<!-- Report -->
<div class='container'>
  <div class='row'>
    <h1 class='text-center mx-auto'><%= params[:filter].capitalize if params[:filter] && params[:filter] != 'all' %> Tasks Report</h1>
  </div>

  <div class='row mb-3 w-100'>
    <%= link_to 'Generate PDF', report_pdf_path(filter: params[:filter], format: :pdf), class: 'btn btn-info ml-auto', target: '_blank' %>
  </div>

  <div class='row'>
    <table class='table table-striped table-bordered table-hover report-table' cellspacing='0'>
      <thead class='thead-dark text-center'>
        <tr>
          <th>Title</th>
          <th>Description</th>
          <th>Priority</th>
          <th>Comments</th>
        </tr>
      </thead>
      <tbody>
        <% @tasks.each do |task| %>
          <tr>
            <td><%= task.title %></td>
            <td><%= task.description %></td>
            <td class='<%= task.priority %>'><%= task.priority.capitalize %></td>
            <td>
              <% task.comments.sort_by(&:body).each do |comment| %>
                <%= comment.body %>
                <br/>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
      <tfoot>
        <tr>
          <td colspan='3' class='text-right'>TOTAL</td>
          <td colspan='1' class='text-right' id='total'><%= @tasks.size %></td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>
